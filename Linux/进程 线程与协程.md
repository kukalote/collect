# 进程 线程与协程

系统级：进程与线程
编译器级：协程

### 进程与线程

在系统底层运行机制有**进程**与**线程**。作为软件，执行过程中至少要开一个进程，而一个进程至少要生成一个线程来执行逻辑。

**进程**是资源的分配和调度的一个独立单元，而**线程**是CPU调度的基本单元。

**线程**间共享进程的地址空间;而**进程**有自己独立的地址空间;因此线程可以读写同样的数据结构和变量，便于线程之间的通信。相反，进程间通信（IPC）很困难且消耗更多资源。 

### 线程与协程

**线程**执行过程是用时间片标记，时间片用完时会进行线程切换，并产生资源释放与加载。

**线程**间可以共同访问进程的地址空间，但此种读写为排他锁形式。

**多线程**在多核CPU上，可以实现并行。

**协程**是编译器级别或者用户级别生成调度器，来实现在单一线程上切换子程序。避免无意义调度，不会产生上下文的加载释放。

**协程**间资源为共享锁。

**协程**被调试到单一线程上执行，失去了标准线程在多CPU上执行的能力。



补充：

**协程**可理解为子程序，多个子程序被调试器安排在单一线程上执行。此线程在执行过程中，可以避免无意义的调度，线程间频繁的切换。此时**线程**的切换点都是时间片超过一定阈值，或者进入I/O或睡眠等状态。

**协程**会通过多个进程产生的多线程，将子程序挂入有多CPU执行能力的线程上，来产生并发的能力。

**线程**间在多CPU上可以并发，**协程**在同一线程上时便是串行。



