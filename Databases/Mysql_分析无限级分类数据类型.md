### MySQL_分析无限级分类数据类型

看了下网上写的无限级分类时的表设计, 比较附合无限级大数据量的有 : 

id | pid | title | lft | rgt | order 
---|---|---|---|---|---
表主键 | 元素父级id | 元素名称 | 元素左序 | 元素右序 | 元素序号   


这种的优点 : 

- 查询起来很快, 因为有了左右序, 就有了左右界限, 查询其子集时非常方便;
- 可以用左序将不同分支下的元素有效的组织起来。

而缺点则是 : 

- 这种方式插入和删除时很不方便, 要执行大量的 `update` 操作。

所以经过考虑, 我想如果可以在元素之前根据项目需求加上一些数据空档应该会减少很多数据操作时的修改。如下图 : 

![image](./tips_1.jpg)

试想一下,  如果图中的 (1,10,12,14,16,18,20,30,32,34,40,50), 是写成 (1,2,3,4,5,6,7,8,9,10,11,12) 的话, 每次节点的添加、删除操作都会有大量节点的 `lft` 和 `rgt` 数据会变动。
> ![image](./tips_2.jpg)

如果像上图, 元素之间留出一些数据空隙, 只会进行小分支甚至不用进行数据修改。至少现在删除操作就不用修改, 只要删除指定的节点, 就可以了。

#### 查询节点

查询 fruit 节点下子集时 : 

`SELECT * FROM table WHERE lft>10 AND rgt<20 ORDER BY lft;`

#### 移除节点

这里是有一定数据空隙的, 所以直接删除就可以了。

#### 添加节点

在 vegetables 下添加 tomato : 

之前要先知道 vegetables 节点中最末子节点的 rgt 值, 如果 potato 的 rgt 值 与 vegetables 的 rgt 值之间数字空隙大于等于 2 时, 则可以再插入节点。

比如  vegetables id 为 5, tomato 的 lft 和 rgt 值可以是 : step `((40-30-2)/2)/2 ＝ 2` 30+2*3 = 36, 36+2 = 38

`insert into table set (pid, title, lft, rgt, order) values(5, 'tomato', 36, 38, 0);`